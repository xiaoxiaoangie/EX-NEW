# EX平台业务流程与功能清单

## 文档说明
本文档梳理了EX平台从服务商(SP)、租户(TP)到商户(Merchant)的完整业务流程，并详细列举了每个角色的功能点。

---

## 一、业务角色定义

### 1.1 服务商 (Service Provider - SP)
- **定义**：提供支付产品和服务的金融机构或支付公司
- **典型角色**：银行、支付机构、卡组织、本地支付渠道
- **核心价值**：提供底层支付能力和金融产品

### 1.2 租户 (Tenant Partner - TP)
- **定义**：使用EX平台的合作伙伴，可以是代理商或平台运营方
- **典型角色**：支付代理商、行业解决方案提供商、区域合作伙伴
- **核心价值**：整合SP产品，服务终端商户

### 1.3 商户 (Merchant)
- **定义**：最终使用支付服务的企业客户
- **典型角色**：电商平台、跨境贸易公司、SaaS服务商
- **核心价值**：使用支付服务完成业务交易

---

## 二、业务流程图

```
EX平台 (Super Admin)
    ↓
    ├─→ 服务商(SP) ─→ 上架产品 ─→ EX产品库
    │                              ↓
    ├─→ 租户(TP) ─→ 采购产品 ←─────┘
    │       ↓
    │   配置定价/汇率
    │       ↓
    └─→ 商户(Merchant) ─→ 签约产品 ←─ TP
            ↓
        使用支付服务
            ↓
        产生交易 → 分佣结算 → TP → SP
```

---

## 三、服务商 (SP) 功能清单

### 3.1 产品管理
#### 3.1.1 产品上架
- [ ] 产品基本信息配置
  - 产品名称、产品类型（收款/付款/换汇/Crypto/卡片/收单）
  - 产品描述、适用场景
  - 支持币种、支持国家/地区
  - 产品状态（草稿/待审核/已上架/已下架）

- [ ] 产品能力配置
  - 交易限额（单笔/单日/单月）
  - 结算周期（T+0/T+1/T+N）
  - 支持的支付方式
  - API接口能力

- [ ] 产品定价
  - 基础费率配置
  - 阶梯费率设置
  - 固定手续费
  - 汇率加点配置

#### 3.1.2 产品管理
- [ ] 产品列表查看
- [ ] 产品编辑/更新
- [ ] 产品上下架管理
- [ ] 产品版本管理

### 3.2 TP管理
#### 3.2.1 TP接入管理
- [ ] TP接入申请审核
- [ ] TP资质审核（KYB）
- [ ] TP签约管理
- [ ] TP账号开通

#### 3.2.2 TP关系管理
- [ ] TP列表查看
- [ ] TP基本信息管理
- [ ] TP状态管理（正常/冻结/停用）
- [ ] TP层级管理

#### 3.2.3 TP产品授权
- [ ] 产品授权管理
- [ ] TP专属定价
- [ ] TP产品配额管理
- [ ] 产品使用监控

### 3.3 销售中心（SP视角）
#### 3.3.1 TP合作管理
- [ ] TP合作伙伴列表
- [ ] TP层级管理
- [ ] TP合作协议管理

#### 3.3.2 分佣管理
- [ ] 分佣规则配置（给TP的分佣）
- [ ] TP分佣账单生成
- [ ] TP分佣明细查询
- [ ] 分佣统计报表

#### 3.3.3 结算管理
- [ ] TP结算单生成
- [ ] TP付款单管理
- [ ] 结算记录查询
- [ ] 结算审核流程

### 3.4 订单管理
- [ ] 订单列表查看
- [ ] 订单详情查询
- [ ] 订单统计分析
- [ ] 订单导出

### 3.5 渠道管理
#### 3.5.1 渠道配置
- [ ] 银行渠道配置
- [ ] 卡组织配置
- [ ] 本地支付渠道配置
- [ ] Crypto渠道配置

#### 3.5.2 渠道监控
- [ ] 渠道成功率监控
- [ ] 渠道可用性监控
- [ ] 渠道限额监控
- [ ] 渠道告警配置

### 3.6 清结算中心
#### 3.6.1 清算管理
- [ ] 清算任务配置
- [ ] 清算记录查询
- [ ] 清算规则管理

#### 3.6.2 结算管理
- [ ] 结算任务配置
- [ ] 结算记录查询
- [ ] 结算规则管理

#### 3.6.3 对账管理
- [ ] 对账任务配置
- [ ] 对账差异处理
- [ ] 对账报表

### 3.7 财务中心
- [ ] 账户余额管理
- [ ] 资金流水查询
- [ ] 应收账款管理
- [ ] 应付账款管理
- [ ] 财务对账

### 3.8 数据报表
- [ ] 交易统计报表
- [ ] TP业绩报表
- [ ] 分佣统计报表
- [ ] 财务报表
- [ ] 自定义报表

### 3.9 风控合规
- [ ] 风控规则配置
- [ ] 交易监控
- [ ] 异常交易处理
- [ ] 合规报告

### 3.10 技术服务
- [ ] API文档提供
- [ ] Webhook配置
- [ ] 沙箱环境
- [ ] 技术支持

---

## 四、租户 (TP) 功能清单

### 4.1 工作台 (Dashboard)
#### 4.1.1 数据概览
- [ ] 今日交易概览
- [ ] 本月业绩统计
- [ ] 商户数量统计
- [ ] 待办事项提醒

#### 4.1.2 实时监控
- [ ] 交易实时监控
- [ ] 成功率监控
- [ ] 异常交易告警

#### 4.1.3 快捷操作
- [ ] 快速开户
- [ ] 快速签约
- [ ] 快速查询

### 4.2 采购中心
#### 4.2.1 产品市场
- [ ] 浏览SP产品
- [ ] 产品搜索/筛选
- [ ] 产品详情查看
- [ ] 产品对比功能
- [ ] 收藏产品

#### 4.2.2 我的产品
- [ ] 已签约产品列表
- [ ] 待生效产品
- [ ] 即将到期产品
- [ ] 产品续签

#### 4.2.3 签约管理
- [ ] 发起签约申请
- [ ] 签约记录查询
- [ ] 合同管理
- [ ] 续签管理

### 4.3 供应中心
#### 4.3.1 产品管理
- [ ] 产品列表（已采购的产品）
- [ ] 产品配置（面向商户）
- [ ] 产品定价（给商户的价格）
- [ ] 产品上下架

#### 4.3.2 产品定价
- [ ] 基础费率配置
- [ ] 差异化定价
- [ ] 汇率加点配置
- [ ] 定价模板管理

### 4.4 商户中心
#### 4.4.1 商户管理
- [ ] 商户列表
- [ ] 新建商户
- [ ] 商户基本信息管理
- [ ] 商户状态管理（正常/冻结/停用）
- [ ] 商户层级管理

#### 4.4.2 商户签约
- [ ] 商户签约产品
- [ ] 商户专属报价
- [ ] 商户专属汇率
- [ ] 签约审核

#### 4.4.3 商户交易管理
- [ ] VA账户管理
- [ ] 收款交易查询
- [ ] 付款交易查询
- [ ] 换汇交易查询
- [ ] On/Off Ramp交易
- [ ] Crypto交易查询
- [ ] 卡片交易查询
- [ ] 收单交易查询

#### 4.4.4 交易背景管理
- [ ] 订单管理
- [ ] 订单文件管理
- [ ] 店铺管理

#### 4.4.5 商户分佣
- [ ] 商户分佣规则配置
- [ ] 商户分佣账单
- [ ] 商户分佣明细

### 4.5 销售中心（TP视角）
#### 4.5.1 代理商管理
- [ ] 代理商列表
- [ ] 新建代理商
- [ ] 代理商层级管理
- [ ] 代理商授权管理

#### 4.5.2 分佣管理
- [ ] 分佣规则配置（给代理商）
- [ ] 分佣账单生成
- [ ] 分佣明细查询
- [ ] 分佣统计

#### 4.5.3 结算管理
- [ ] 结算单生成
- [ ] 付款单管理
- [ ] 结算记录查询

### 4.6 账户中心
#### 4.6.1 账户总览
- [ ] 账户余额查询
- [ ] 多币种余额
- [ ] 冻结资金查询

#### 4.6.2 资金流水
- [ ] 交易记录
- [ ] 充值记录
- [ ] 提现记录

#### 4.6.3 分佣收益
- [ ] 分佣账单（从SP获得的分佣）
- [ ] 收益明细
- [ ] 收益统计

#### 4.6.4 结算提现
- [ ] 待结算查询
- [ ] 发起提现
- [ ] 提现记录

### 4.7 数据中心
#### 4.7.1 交易报表
- [ ] 交易统计
- [ ] 交易趋势分析
- [ ] 成功率分析

#### 4.7.2 商户报表
- [ ] 商户分析
- [ ] 商户排行
- [ ] 商户增长分析

#### 4.7.3 财务报表
- [ ] 收入报表
- [ ] 分佣报表
- [ ] 成本报表

#### 4.7.4 数据导出
- [ ] 报表导出
- [ ] 定时报表

### 4.8 工单中心
- [ ] 提交工单
- [ ] 工单列表
- [ ] 工单处理进度
- [ ] 工单历史记录

### 4.9 开发者中心
#### 4.9.1 API接入
- [ ] API文档查看
- [ ] 接口列表
- [ ] SDK下载

#### 4.9.2 密钥管理
- [ ] API密钥管理
- [ ] 证书管理

#### 4.9.3 回调配置
- [ ] Webhooks配置
- [ ] 回调日志查询

#### 4.9.4 测试工具
- [ ] API调试工具
- [ ] 沙箱环境

### 4.10 设置
#### 4.10.1 账号设置
- [ ] 个人资料
- [ ] 安全设置
- [ ] 登录日志

#### 4.10.2 企业设置
- [ ] 公司信息
- [ ] 品牌设置
- [ ] 业务配置

#### 4.10.3 团队管理
- [ ] 成员管理
- [ ] 角色管理
- [ ] 权限配置
- [ ] 部门管理

---

## 五、商户 (Merchant) 功能清单

### 5.1 Dashboard（工作台）
#### 5.1.1 概览
- [ ] 账户余额展示
- [ ] 今日交易统计
- [ ] 本月交易统计
- [ ] 待处理事项

#### 5.1.2 快捷入口
- [ ] 快速收款
- [ ] 快速付款
- [ ] 快速换汇
- [ ] 快速查询

### 5.2 资产管理 (Assets)
#### 5.2.1 法币账户 (Fiat Accounts)
- [ ] 多币种余额查看
  - USD账户
  - EUR账户
  - GBP账户
  - HKD账户
  - 其他币种
- [ ] 可用余额/冻结余额
- [ ] 账户设置
- [ ] 交易记录查询

#### 5.2.2 加密货币钱包 (Crypto Wallet)
- [ ] 加密货币余额查看
  - USDT (TRC20/ERC20)
  - USDC (ERC20)
  - BTC
  - ETH
- [ ] 可用余额/冻结余额
- [ ] 充值地址管理
- [ ] 交易记录查询

### 5.3 转账 (Transfer)
#### 5.3.1 收款 (Payins)
- [ ] 创建收款订单
- [ ] 收款方式选择
  - 银行转账
  - 本地支付
  - 卡支付
  - Crypto收款
- [ ] 收款记录查询
- [ ] 收款状态跟踪
- [ ] 收款通知

#### 5.3.2 付款 (Payouts)
- [ ] 创建付款订单
- [ ] 收款人管理
- [ ] 批量付款
- [ ] 付款记录查询
- [ ] 付款状态跟踪
- [ ] 付款审核（如需要）

#### 5.3.3 换汇 (Exchange)
- [ ] 实时汇率查询
- [ ] 创建换汇订单
- [ ] 换汇记录查询
- [ ] 锁汇功能（如支持）

### 5.4 加密货币 (Crypto)
#### 5.4.1 充值 (Deposit)
- [ ] 生成充值地址
- [ ] 充值记录查询
- [ ] 充值到账通知
- [ ] 网络选择（TRC20/ERC20等）

#### 5.4.2 提现 (Withdrawal)
- [ ] 创建提现订单
- [ ] 提现地址管理
- [ ] 提现记录查询
- [ ] 提现审核状态

#### 5.4.3 兑换 (Swap)
- [ ] Crypto ↔ Fiat兑换
- [ ] Crypto ↔ Crypto兑换
- [ ] 实时汇率查询
- [ ] 兑换记录查询

#### 5.4.4 On/Off Ramp
- [ ] 法币入金（On-Ramp）
- [ ] 法币出金（Off-Ramp）
- [ ] 交易记录
- [ ] 限额查询

### 5.5 卡片 (Cards)
#### 5.5.1 虚拟卡 (Virtual Cards)
- [ ] 申请虚拟卡
- [ ] 卡片列表
- [ ] 卡片详情（卡号、CVV、有效期）
- [ ] 卡片充值
- [ ] 卡片冻结/解冻
- [ ] 卡片注销

#### 5.5.2 实体卡 (Physical Cards)
- [ ] 申请实体卡
- [ ] 卡片激活
- [ ] 卡片挂失
- [ ] 卡片补办

#### 5.5.3 卡片交易
- [ ] 交易记录查询
- [ ] 交易限额设置
- [ ] 交易通知设置

### 5.6 收单 (Acquiring)
#### 5.6.1 支付网关
- [ ] 支付链接生成
- [ ] 支付页面配置
- [ ] 支付方式配置

#### 5.6.2 订单管理
- [ ] 订单列表
- [ ] 订单详情
- [ ] 订单退款
- [ ] 订单导出

#### 5.6.3 店铺管理
- [ ] 店铺信息配置
- [ ] 店铺Logo/品牌
- [ ] 支付页面定制

### 5.7 报表 (Reports)
#### 5.7.1 交易报表
- [ ] 交易汇总报表
- [ ] 交易明细报表
- [ ] 按产品分类统计
- [ ] 按币种分类统计
- [ ] 按时间维度统计

#### 5.7.2 财务报表
- [ ] 收入报表
- [ ] 支出报表
- [ ] 手续费报表
- [ ] 利润报表

#### 5.7.3 对账报表
- [ ] 日对账报表
- [ ] 月对账报表
- [ ] 差异报表

#### 5.7.4 报表导出
- [ ] Excel导出
- [ ] PDF导出
- [ ] CSV导出
- [ ] 定时报表邮件

### 5.8 开发者 (Developer)
#### 5.8.1 API密钥
- [ ] 生成API Key
- [ ] API Key管理
- [ ] API Key权限配置
- [ ] API Key安全设置

#### 5.8.2 Webhooks
- [ ] Webhook URL配置
- [ ] Webhook事件订阅
- [ ] Webhook日志查询
- [ ] Webhook重试

#### 5.8.3 API文档
- [ ] API文档查看
- [ ] 接口示例
- [ ] SDK下载

#### 5.8.4 沙箱环境
- [ ] 沙箱账号
- [ ] 测试数据
- [ ] API调试工具

### 5.9 设置 (Settings)
#### 5.9.1 账户设置
- [ ] 公司信息
- [ ] 联系信息
- [ ] 业务信息
- [ ] KYB认证

#### 5.9.2 安全设置
- [ ] 密码修改
- [ ] 双因素认证(2FA)
- [ ] 登录设备管理
- [ ] 操作日志

#### 5.9.3 通知设置
- [ ] 邮件通知配置
- [ ] 短信通知配置
- [ ] Webhook通知配置
- [ ] 通知语言设置

#### 5.9.4 团队管理
- [ ] 成员管理
- [ ] 角色权限
- [ ] 审批流程配置

#### 5.9.5 收款人管理
- [ ] 收款人列表
- [ ] 新增收款人
- [ ] 收款人认证
- [ ] 收款人分组

---

## 六、业务流程详解

### 6.1 产品上架流程
```
SP → 创建产品 → 配置产品信息 → 设置定价 → 提交审核(EX) → 审核通过 → 产品上架
```

### 6.2 TP采购流程
```
TP → 浏览产品市场 → 选择产品 → 查看产品详情 → 发起签约申请 → SP审核 → 签约成功 → 产品可用
```

### 6.3 商户开户流程
```
TP → 创建商户 → 填写商户信息 → KYB认证 → TP审核 → 开户成功 → 分配账号 → 商户登录
```

### 6.4 商户签约产品流程
```
商户登录 → 查看可用产品 → 选择产品 → 提交签约申请 → TP审核 → 签约成功 → 产品激活 → 可使用
```

### 6.5 交易流程（以收款为例）
```
商户 → 创建收款订单 → 选择支付方式 → 生成支付链接 → 客户支付 → 渠道处理 → 
资金到账 → 通知商户 → 记录交易 → 生成分佣 → 结算
```

### 6.6 分佣结算流程
```
交易完成 → 计算分佣（商户→TP→SP） → 生成分佣账单 → 
TP确认 → SP确认 → 生成结算单 → 付款 → 结算完成
```

---

## 七、关键业务规则

### 7.1 定价规则
- **SP定价**：SP设置给TP的基础价格
- **TP定价**：TP在SP价格基础上加点，设置给商户的价格
- **商户成本**：商户实际支付的费用
- **分佣计算**：商户成本 - SP成本 = 总利润，按分佣规则分配给TP和SP

### 7.2 汇率规则
- **汇率源**：EX平台统一管理汇率源
- **汇率加点**：TP可在基础汇率上加点
- **汇率更新**：实时/定时更新
- **锁汇功能**：支持锁定汇率一定时间

### 7.3 结算规则
- **结算周期**：T+0/T+1/T+N
- **结算币种**：支持多币种结算
- **结算方式**：自动结算/手动结算
- **结算限额**：最小结算金额

### 7.4 风控规则
- **交易限额**：单笔/单日/单月限额
- **风险评分**：基于交易行为的风险评分
- **黑白名单**：IP/设备/账户黑白名单
- **异常监控**：异常交易实时告警

---

## 八、系统集成点

### 8.1 SP系统集成
- [ ] 产品API对接
- [ ] 交易API对接
- [ ] 对账文件对接
- [ ] Webhook通知

### 8.2 TP系统集成
- [ ] 商户管理API
- [ ] 交易查询API
- [ ] 报表API
- [ ] Webhook通知

### 8.3 商户系统集成
- [ ] 支付API
- [ ] 查询API
- [ ] Webhook回调
- [ ] SDK集成

---

## 九、数据流转

### 9.1 产品数据流
```
SP产品库 → EX产品中心 → TP产品库 → 商户可用产品
```

### 9.2 交易数据流
```
商户发起交易 → TP系统 → EX路由 → SP渠道 → 交易处理 → 
结果返回 → EX记录 → TP记录 → 商户记录
```

### 9.3 资金流
```
客户付款 → 渠道账户 → SP账户 → TP账户 → 商户账户
```

### 9.4 分佣流
```
交易利润 → 分佣计算 → TP分佣账户 → SP分佣账户 → 定期结算
```

---

## 十、权限矩阵

| 功能模块 | SP | TP | 商户 | EX管理员 |
|---------|----|----|------|----------|
| 产品上架 | ✓ | ✗ | ✗ | ✓ |
| 产品采购 | ✗ | ✓ | ✗ | ✓ |
| 商户开户 | ✗ | ✓ | ✗ | ✓ |
| 商户签约 | ✗ | ✓ | 申请 | ✓ |
| 发起交易 | ✗ | ✗ | ✓ | ✗ |
| 交易查询 | 自己的 | 自己的 | 自己的 | 全部 |
| 分佣配置 | ✓ | ✓ | ✗ | ✓ |
| 结算管理 | ✓ | ✓ | ✗ | ✓ |
| 系统配置 | ✗ | ✗ | ✗ | ✓ |

---

## 十一、技术架构建议

### 11.1 系统分层
```
展示层：SP Portal / TP Portal / Merchant Portal / SA Portal
业务层：产品服务 / 交易服务 / 账户服务 / 分佣服务
数据层：产品库 / 交易库 / 账户库 / 日志库
```

### 11.2 核心服务
- **产品服务**：产品管理、产品配置、产品授权
- **交易服务**：交易路由、交易处理、交易查询
- **账户服务**：账户管理、余额管理、流水记录
- **分佣服务**：分佣计算、账单生成、结算管理
- **汇率服务**：汇率管理、汇率查询、汇率路由
- **风控服务**：风险评估、规则引擎、监控告警

---

## 十二、实施建议

### 12.1 MVP功能优先级
**P0（必须）**
- 商户开户
- 产品签约
- 基础收付款
- 交易查询
- 账户管理

**P1（重要）**
- 换汇功能
- 分佣结算
- 报表统计
- API接入

**P2（优化）**
- Crypto功能
- 卡片功能
- 高级报表
- 自动化工具

### 12.2 分阶段实施
**阶段一：基础平台**
- EX管理后台
- SP Portal基础功能
- TP Portal基础功能
- Merchant Portal基础功能

**阶段二：业务完善**
- 完整交易流程
- 分佣结算体系
- 报表系统
- API体系

**阶段三：高级功能**
- Crypto集成
- 卡片服务
- 智能路由
- 风控系统

---

## 附录：术语表

| 术语 | 全称 | 说明 |
|-----|------|------|
| EX | Exchange Platform | 交易平台 |
| SA | Super Admin | 超级管理员 |
| SP | Service Provider | 服务商 |
| TP | Tenant Partner | 租户/合作伙伴 |
| KYB | Know Your Business | 企业认证 |
| KYC | Know Your Customer | 客户认证 |
| API | Application Programming Interface | 应用程序接口 |
| Webhook | Web Callback | 网络回调 |
| On-Ramp | Fiat to Crypto | 法币入金 |
| Off-Ramp | Crypto to Fiat | 法币出金 |
| VA | Virtual Account | 虚拟账户 |
| MK | Markup | 加点/加价 |

---

**文档版本**：v1.0  
**最后更新**：2026-02-02  
**维护者**：EX产品团队
